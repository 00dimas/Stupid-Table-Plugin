(function(f){f.fn.stupidtable=function(l){return this.each(function(){var h=f(this);l=l||{};l=f.extend({},{"int":function(d,a){return parseInt(d,10)-parseInt(a,10)},"float":function(d,a){return parseFloat(d)-parseFloat(a)},string:function(d,a){return d<a?-1:d>a?1:0}},l);h.on("click","th",function(){var d=h.children("tbody").children("tr"),a=f(this),m=0;h.find("th").slice(0,a.index()).each(function(){var a=f(this).attr("colspan")||1;m+=parseInt(a)});var e=a.data("sort")||null;if(e){var c=l[e],g=[];
d.each(function(a,c){var b=f(c).children().eq(m),d=b.data("sort-value"),b="undefined"!==typeof d?d:b.text();g.push(b)});var e=[],b=g.slice(0),j=g.slice(0).reverse(),k=g.slice(0).sort(c);if((b&&k&&!(b<k||k<b)||j&&k&&!(j<k||k<j))&&null!==a.data("sort-dir")){g.reverse();for(c=g.length-1;0<=c;c--)e.push(c)}else{e=g.slice(0).sort(c);c=[];for(j=b=0;j<g.length;j++){for(b=f.inArray(g[j],e);-1!=f.inArray(b,c);)b++;c.push(b)}e=c}c="asc"===a.data("sort-dir")?"desc":"asc";h.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc");
a.data("sort-dir",c).addClass("sorting-"+c);h.trigger("beforetablesort",{column:m,direction:c});a=e;e=d.slice(0);for(b=0;b<a.length;b++)newIndex=a[b],e[newIndex]=d[b];d=f(e);h.children("tbody").append(d);h.trigger("aftertablesort",{column:m,direction:c})}})})}})(jQuery);